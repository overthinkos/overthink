defaults:
  registry: ghcr.io/atrawog
  tag: auto

  platforms:
    - linux/amd64
    - linux/arm64
  pkg: rpm
  merge:
    auto: false
    max_mb: 128
  builder: fedora-builder

images:

  fedora:
    base: "quay.io/fedora/fedora:43"
    pkg: rpm

  fedora-builder:
    base: fedora
    layers:
      - pixi
      - nodejs
      - build-toolchain

  ubuntu:
    enabled: false
    base: "ubuntu:24.04"
    pkg: deb

  debian:
    enabled: false
    base: "debian:13"
    pkg: deb

  fedora-test:
    base: fedora
    layers:
      - traefik
      - testapi
    ports:
      - "8000:8000"
      - "8080:8080"

  openclaw:
    base: fedora
    layers:
      - openclaw
    ports:
      - "18789:18789"

  nvidia:
    base: fedora
    layers:
      - cuda
    platforms:
      - linux/amd64

  python-ml:
    base: nvidia
    layers:
      - python-ml
    platforms:
      - linux/amd64

  jupyter:
    base: nvidia
    layers:
      - jupyter
    ports:
      - "8888:8888"
    platforms:
      - linux/amd64

  ollama:
    base: nvidia
    layers:
      - ollama
    ports:
      - "11434:11434"
    platforms:
      - linux/amd64

  openclaw-ollama:
    base: nvidia
    layers:
      - openclaw
      - ollama
    ports:
      - "18789:18789"
      - "11434:11434"
    platforms:
      - linux/amd64

  comfyui:
    base: nvidia
    layers:
      - comfyui
    ports:
      - "8188:8188"
    platforms:
      - linux/amd64

  githubrunner:
    base: fedora
    layers:
      - github-runner
    platforms:
      - linux/amd64
    uid: 0
    gid: 0
    user: root

  bazzite-ai:
    enabled: false
    base: "ghcr.io/ublue-os/bazzite-nvidia-open:stable-43.20260120.1"
    bootc: true
    platforms:
      - linux/amd64
    layers:
      - build-toolchain
      - language-runtimes
      - ujust
      - dev-tools
      - github-actions
      - virtualization
      - kubernetes
      - docker-ce
      - google-cloud
      - vr-streaming
      - cuda
      - devops-tools
      - grafana-tools
      - desktop-apps
      - vscode
      - typst
      - copr-desktop
      - os-config
      - os-system-files
